(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{86:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(21),s=n.n(a),i=n(90),u=n(92),o=n(10),l=n(1),j=function(){var e=Object(o.c)((function(e){return e.notification})),t={borderStyle:"solid",borderRadius:5,padding:10,color:"success"===e.type?"green":"red",background:"lightgrey"};return e.message?Object(l.jsx)("div",{style:t,children:e.message}):null},d=n(19),b=n(88),p=c.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),c=Object(d.a)(n,2),a=c[0],s=c[1],i={display:a?"none":""},u={display:a?"":"none"},o=function(){s(!a)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:o}})),Object(l.jsxs)("div",{children:[Object(l.jsx)("div",{style:i,children:Object(l.jsx)(b.a,{id:"beforeToggle",variant:"outline-success",type:"text",onClick:o,children:e.buttonLabel})}),Object(l.jsxs)("div",{style:u,children:[e.children,Object(l.jsx)(b.a,{id:"cancel",variant:"secondary",onClick:o,children:"cancel"})]})]})}));p.displayName="Togglable";var f,h=p,O=n(3),v=n.n(O),x=n(8),m=n(55),g=n(16),y=n.n(g),w="/api/blogs",k=null,L=function(){return{headers:{Authorization:k}}},S=function(){var e=Object(x.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get(w);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=Object(x.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get("".concat(w,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(x.a)(v.a.mark((function e(t,n){var r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.post("".concat(w,"/").concat(t,"/comments"),n,L());case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),C={getAll:S,getOne:T,create:function(){var e=Object(x.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.post(w,t,L());case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(x.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.put("".concat(w,"/").concat(t.id),t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){k="bearer ".concat(e)},remove:function(){var e=Object(x.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.delete("".concat(w,"/").concat(t),L());case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),postComment:E},N=function(e){return function(){var t=Object(x.a)(v.a.mark((function t(n){var r;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C.create(e);case 2:r=t.sent,n({type:"NEW_BLOG",data:r});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},I=function(e){return function(){var t=Object(x.a)(v.a.mark((function t(n){var r;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.update(e);case 3:r=t.sent,n({type:"LIKE_BLOG",data:r}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},G=function(e){return function(){var t=Object(x.a)(v.a.mark((function t(n){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.confirm("Remove blog ".concat(e.title," by ").concat(e.author))){t.next=11;break}return t.prev=2,t.next=5,C.remove(e.id);case 5:n({type:"REMOVE_BLOG",data:e.id}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(e){return t.apply(this,arguments)}}()},_=function(e,t){return function(){var n=Object(x.a)(v.a.mark((function n(r){var c,a;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=e.id,n.prev=1,n.next=4,C.postComment(c,{comment:t});case 4:a=n.sent,r({type:"COMMENT_BLOG",data:a}),n.next=11;break;case 8:return n.prev=8,n.t0=n.catch(1),n.abrupt("return",Promise.reject(n.t0));case 11:case"end":return n.stop()}}),n,null,[[1,8]])})));return function(e){return n.apply(this,arguments)}}()},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"NEW_BLOG":return[].concat(Object(m.a)(e),[t.data]);case"LIKE_BLOG":var n=t.data;return e.map((function(e){return e.id===n.id?n:e}));case"REMOVE_BLOG":var r=t.id;return e.filter((function(e){return e.id!==r}));case"COMMENT_BLOG":return e.map((function(e){return e.id===t.data.id?t.data:e}));default:return e}},R=n(91),U=function(e){var t=e.blogFormRef,n=Object(r.useState)(""),c=Object(d.a)(n,2),a=c[0],s=c[1],i=Object(r.useState)(""),u=Object(d.a)(i,2),j=u[0],p=u[1],f=Object(r.useState)(""),h=Object(d.a)(f,2),O=h[0],m=h[1],g=Object(o.b)(),y=function(){var e=Object(x.a)(v.a.mark((function e(n){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),g(N({title:a,author:j,url:O})),t.current.toggleVisibility(),s(""),p(""),m("");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(l.jsxs)("div",{children:[Object(l.jsx)("h2",{children:"Create new"}),Object(l.jsxs)(R.a,{onSubmit:y,children:[Object(l.jsxs)(R.a.Group,{children:[Object(l.jsx)(R.a.Label,{children:"title"}),Object(l.jsx)(R.a.Control,{id:"title",type:"text",value:a,onChange:function(e){s(e.target.value)}}),Object(l.jsx)(R.a.Label,{children:"author"}),Object(l.jsx)(R.a.Control,{id:"author",type:"text",value:j,onChange:function(e){p(e.target.value)}}),Object(l.jsx)(R.a.Label,{children:"url"}),Object(l.jsx)(R.a.Control,{id:"url",type:"text",value:O,onChange:function(e){m(e.target.value)}})]}),Object(l.jsx)(b.a,{id:"create",variant:"primary",type:"submit",children:"create"})]})]})},A=n(28),M=n(9),F=n(50),D=n.n(F),J=function(e,t,n){return function(){var r=Object(x.a)(v.a.mark((function r(c){return v.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:c({type:"SET_NOTIF",notification:{message:e,type:t}}),f&&clearTimeout(f),f=setTimeout((function(){c({type:"SET_NOTIF",notification:{message:null,type:null}})}),1e3*n);case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{message:null,type:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIF":return t.notification;default:return e}},W=function(e){var t=e.handleComment;return Object(l.jsx)("div",{children:Object(l.jsxs)(R.a,{onSubmit:t,children:[Object(l.jsxs)(R.a.Group,{children:[Object(l.jsx)(R.a.Label,{children:"comment"}),Object(l.jsx)(R.a.Control,{type:"text",id:"comment",name:"name"})]}),Object(l.jsx)(b.a,{variant:"primary",type:"submit",children:"add comment"})]})})},K=function(){var e=Object(r.useState)(null),t=Object(d.a)(e,2),n=t[0],c=t[1],a=Object(o.c)((function(e){return e.user})),s=Object(o.b)(),i=Object(M.f)(),u=Object(M.g)().id;Object(r.useEffect)((function(){return function(){var e=Object(x.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getOne(u);case 2:t=e.sent,c(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),function(){return!1}}),[]);var j=function(){var e=Object(x.a)(v.a.mark((function e(t){var r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=t.target.comment.value,t.target.comment.value="",""===r||null===r){e.next=7;break}s(_(n,r)).then((function(e){var t=Object(A.a)(Object(A.a)({},n),{},{comments:n.comments.concat(r)});s(J("added a comment","success",5)),c(t)})).catch((function(e){s(J("session expired","error",5))})),e.next=9;break;case 7:return s(J("comment can't be empty","error",5)),e.abrupt("return",null);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(x.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(A.a)(Object(A.a)({},t),{},{likes:t.likes+1}),s(I(n)),c(n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(x.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s(G(t)),i.push("/"),c(null);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();if(n){var h=a&&a.username===n.user.username;return Object(l.jsxs)("div",{className:"blog",children:[Object(l.jsx)("div",{children:Object(l.jsxs)("h2",{children:[Object(l.jsx)("i",{children:n.title})," ",n.author," "]})}),Object(l.jsxs)("div",{children:[Object(l.jsx)("a",{href:"".concat(n.url),children:n.url}),Object(l.jsxs)("div",{children:["likes ",n.likes,Object(l.jsx)(b.a,{className:"ml-2",variant:"primary",onClick:function(){return p(n)},children:"Like"})]}),Object(l.jsxs)("div",{children:["added by ",n.user.name]}),h&&Object(l.jsx)(b.a,{className:"m-1",variant:"primary",onClick:function(){return f(n)},children:"remove"})]}),Object(l.jsx)(W,{handleComment:j}),0!==n.comments.length&&Object(l.jsx)("h4",{children:"comments"}),Object(l.jsx)("ul",{children:n.comments.map((function(e){return Object(l.jsx)("li",{children:e},D()())}))})]})}return null},z=n(13),H=function(){var e=Object(o.c)((function(e){return e.blogs})),t={paddingTop:10,paddngLeft:2,border:"solid",borderWidth:1,marginBottom:5};return Object(l.jsx)("div",{children:e.map((function(e){return Object(l.jsx)("div",{style:t,children:Object(l.jsx)(z.b,{to:"blogs/".concat(e.id),children:e.title},e.id)},e.id)}))})},P={login:function(){var e=Object(x.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},q="loggedBlogAppUser",Q=function(){return JSON.parse(localStorage.getItem(q))},X=function(){return localStorage.removeItem(q)},Y=function(e,t){return function(){var n=Object(x.a)(v.a.mark((function n(r){var c;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,P.login({username:e,password:t});case 3:c=n.sent,window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(c)),C.setToken(c.token),r(J("".concat(c.name," welcome back!"),"success",5)),r({type:"LOGIN",data:c}),n.next=14;break;case 10:n.prev=10,n.t0=n.catch(0),console.log(n.t0),r(J("wrong username/password","error",5));case 14:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e){return n.apply(this,arguments)}}()},Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return t.data;case"LOGOUT":return null;case"SET_USER":return t.data;default:return e}},$=function(){var e=Object(o.b)(),t=Object(M.f)(),n=function(){var n=Object(x.a)(v.a.mark((function n(r){var c,a;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r.preventDefault(),c=r.target.username.value,a=r.target.password.value,e(Y(c,a)),t.push("/");case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:"Login to application"}),Object(l.jsxs)(R.a,{onSubmit:n,children:[Object(l.jsxs)(R.a.Group,{children:[Object(l.jsx)(R.a.Label,{children:"username"}),Object(l.jsx)(R.a.Control,{id:"username",type:"text",name:"username"}),Object(l.jsx)(R.a.Label,{children:"password"}),Object(l.jsx)(R.a.Control,{id:"password",type:"password",name:"password"})]}),Object(l.jsx)(b.a,{id:"login-button",variant:"primary",type:"submit",children:"login"})]})]})},ee=function(){var e=Object(o.b)(),t=Object(M.f)(),n=Object(o.c)((function(e){return e.user}));return Object(l.jsxs)("p",{children:[n.name," logged-in ",Object(l.jsx)(b.a,{id:"logout",variant:"primary",onClick:function(){e((function(e){X(),e({type:"LOGOUT"})})),t.push("/")},children:"logout"})]})},te="/api/users",ne={getAll:function(){var e=Object(x.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get(te);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getUser:function(){var e=Object(x.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get("".concat(te,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":return t.data;default:return e}},ce=n(89),ae=function(e){var t=e.users;return Object(l.jsx)("div",{children:Object(l.jsxs)(ce.a,{striped:!0,bordered:!0,hover:!0,children:[Object(l.jsx)("thead",{children:Object(l.jsxs)("tr",{children:[Object(l.jsx)("th",{children:"user"}),Object(l.jsx)("th",{colSpan:"1",children:"blogs created"})]})}),Object(l.jsx)("tbody",{children:t.map((function(e){return Object(l.jsxs)("tr",{children:[Object(l.jsxs)("td",{children:[" ",Object(l.jsx)(z.b,{to:"/users/".concat(e.id),children:e.name})]}),Object(l.jsx)("td",{children:e.blogs.length})]},e.id)}))})]})})},se=function(){var e=Object(o.c)((function(e){return e.users}));return Object(l.jsxs)("div",{children:[Object(l.jsx)("h4",{children:"Users"}),Object(l.jsx)(ae,{users:e})]})},ie=function(){var e=Object(r.useState)(null),t=Object(d.a)(e,2),n=t[0],c=t[1],a=Object(M.g)().id;return Object(r.useEffect)((function(){(function(){var e=Object(x.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ne.getUser(a);case 3:t=e.sent,c(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[]),n?Object(l.jsxs)("div",{children:[Object(l.jsx)("h2",{children:n.name}),Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:"added blogs"}),Object(l.jsx)("ul",{children:n.blogs.map((function(e){return Object(l.jsx)("li",{children:Object(l.jsx)(z.b,{to:"/blogs/".concat(e.id),children:e.title})},e.id)}))})]})]}):null},ue=function(){var e=Object(o.c)((function(e){return e.user})),t=Object(o.b)();Object(r.useEffect)((function(){t(function(){var e=Object(x.a)(v.a.mark((function e(t){var n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getAll();case 2:n=e.sent,r=n.sort((function(e,t){return t.likes-e.likes})),t({type:"INIT_BLOGS",data:r});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t(function(){var e=Object(x.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne.getAll();case 2:n=e.sent,t({type:"INIT_USERS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var e=Q();e&&(t(function(e){return function(t){t({type:"SET_USER",data:e})}}(e)),C.setToken(e.token))}),[t]);var n=Object(r.useRef)(),c={padding:5};return Object(l.jsxs)("div",{className:"container",children:[Object(l.jsxs)(i.a,{collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark",children:[Object(l.jsx)(i.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),Object(l.jsx)(i.a.Collapse,{id:"responsive-navbar-nav",children:Object(l.jsxs)(u.a,{className:"mr-auto",children:[Object(l.jsx)(u.a.Link,{href:"#",as:"span",children:Object(l.jsx)(z.b,{style:c,to:"/",children:"home"})}),Object(l.jsx)(u.a.Link,{href:"#",as:"span",children:Object(l.jsx)(z.b,{style:c,to:"/",children:"blogs"})}),Object(l.jsx)(u.a.Link,{href:"#",as:"span",children:Object(l.jsx)(z.b,{style:c,to:"/users",children:"users"})}),Object(l.jsx)(u.a.Link,{href:"#",as:"span",children:e?Object(l.jsx)(ee,{}):Object(l.jsx)(z.b,{style:c,to:"/login",children:"login"})})]})})]}),Object(l.jsx)(j,{}),Object(l.jsx)("h2",{children:"Blog App"}),Object(l.jsxs)(M.c,{children:[Object(l.jsx)(M.a,{path:"/users/:id",children:Object(l.jsx)(ie,{})}),Object(l.jsx)(M.a,{path:"/blogs/:id",children:Object(l.jsx)(K,{})}),Object(l.jsx)(M.a,{path:"/users",children:Object(l.jsx)(se,{})}),Object(l.jsx)(M.a,{path:"/login",children:Object(l.jsx)($,{})}),Object(l.jsx)(M.a,{path:"/",children:e?Object(l.jsxs)("div",{children:[Object(l.jsx)(h,{buttonLabel:"create new blog",ref:n,children:Object(l.jsx)(U,{blogFormRef:n})}),Object(l.jsx)(H,{})]}):Object(l.jsx)($,{})})]})]})},oe=n(27),le=n(53),je=n(54),de=Object(oe.combineReducers)({blogs:B,user:Z,users:re,notification:V}),be=Object(oe.createStore)(de,Object(le.composeWithDevTools)(Object(oe.applyMiddleware)(je.a)));s.a.render(Object(l.jsx)(o.a,{store:be,children:Object(l.jsx)(z.a,{children:Object(l.jsx)(ue,{})})}),document.getElementById("root"))}},[[86,1,2]]]);
//# sourceMappingURL=main.ca8357c2.chunk.js.map